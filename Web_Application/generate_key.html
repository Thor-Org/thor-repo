<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Project Thor - Generate Key</title>
    <link rel="icon" type="image/png" sizes="16x18" href="assets/img/Dark%20Logo%20Brand%20Tab.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cabin:700">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/fonts/ionicons.min.css">
    <link rel="stylesheet" href="assets/css/Animated-numbers-section.css">
    <link rel="stylesheet" href="assets/css/Footer-Dark.css">
    <link rel="stylesheet" href="assets/css/Highlight-Blue.css">
    <link rel="stylesheet" href="assets/css/Nav.css">
    <link rel="stylesheet" href="assets/css/Team-Boxed.css">
    <link rel="stylesheet" href="assets/css/Team-Grid.css">
</head>

<body id="page-top" data-bs-spy="scroll" data-bs-target="#mainNav" data-bs-offset="77">
    <nav class="navbar navbar-light navbar-expand bg-dark shadow" data-bs-toggle="tooltip" data-bss-tooltip="" id="mainNav" style="height: 64px;">
        <div class="container-fluid"><a class="navbar-brand" href="index.html" style="height: 56;color: #f0d804;font-size: 20px;"><img src="assets/img/Dark%20Logo%20Brand.png" height="50">&nbsp;project thor</a>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item nav-link" style="margin: 0;padding: 8px;"><a class="nav-link" href="index.html" style="background: transparent;">About</a></li>
                    <li class="nav-item nav-link" style="margin: 0;"><a class="nav-link active" href="generate_key.html" style="background: transparent;">Generate Key</a></li>
                    <li class="nav-item nav-link" style="margin: 0;"><a class="nav-link" href="team.html" style="background: transparent;">Team</a></li>
                    <li class="nav-item dropdown" style="max-height: 56px;margin: 0px;padding: 8px;"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#" style="background: transparent;">Learn More</a>
                        <div class="dropdown-menu dropdown-menu-dark"><a class="dropdown-item" href="problem.html">Problem</a><a class="dropdown-item" href="solution.html">Solution</a><a class="dropdown-item" href="data.html">Data</a></div>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item nav-link"><a class="btn" role="button" style="border-radius: 6px;background: var(--bs-blue);" href="contact.html">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <header class="masthead" style="background-image: url('assets/img/intro-bg.jpg');">
        <div class="intro-body">
            <div class="container">
                <div class="row">
                    <div class="col">
                        <h1>Generate&nbsp;Your Encryption&nbsp;Key</h1>
                        <p style="margin: 0px;">Click the button below to generate an md5 encryption</p>
                        <p>key from our set of lightning data.</p><div>
    
<?php
$servername = "192.168.1.5";
$username = "root";
$password = "Sadie1289";

// Create connection
$conn = new mysqli($servername, $username, $password);

// Check connection
if ($conn->connect_error) {
  die("Server: Connection failed: " . $conn->connect_error);
}
echo "Server: Connected<br>";
?>

<?php
          if(isset($_POST['button1'])) {
              $sql = "SELECT * FROM Lightning_Data.combinations
                      ORDER BY RAND()
                      LIMIT 1";
              $result = $conn->query($sql);

              if ($result->num_rows > 0) {
                // output data of each row
                while($row = $result->fetch_assoc()) {
                  $combination = $row["combination"];
                  $strike_time = $row["strike_time"];
                  $nano_seconds = $row["nano_seconds"];
                  $lat = $row["lat"];
                  $lon =$row["lon"];
                  $rise = $row["rise_time"];
                  $fall = $row["fall"];
                  $peak = $row["peak_cur"];
                  //$tex = "Key: ";
                  //echo "Strike time: $strike_time lat: $lat lon: $lon ";
                  //echo $lon;
                  // echo "strike_time: " . $row["strike_time"]. " - lat: " . $row["lat"]. " - lon: " . $row["lon"]. "<br>";
                  // echo "strike_time: " . $strike_time. " - lat: " . $lat. " - lon: " . $lon. "<br>";
                }
                $result->free();
              } else {
                echo "0 results";
              }

              $sql2 = "SELECT * FROM Lightning_Data.keys
                      ORDER BY RAND()
                      LIMIT 1";
              $result2 = $conn->query($sql2);

              if ($result2->num_rows > 0) {
                // output data of each row
                while($row2 = $result2->fetch_assoc()) {
                  $key =$row2["key"];
                }
                $result2->free();
              } else {
                echo "0 keys";
              }

          }
          if(isset($_POST['button2'])) {
            // echo "This is Button2 that is selected with" .$strike_time.;
            echo $strike_time;
            echo $lat;
            echo $lon;
        }
      ?>

</div>
                        <form method="post"><button class="btn btn-primary" data-bs-toggle="tooltip" value="button1" name="button1" type="submit" title="Select to generate your key" style="background: #f9603a;border-radius: 8px;"><i class="fa fa-refresh"></i>   Generate Key</button></form>
                    </div>
                </div>
            </div><?php
echo $tex;
echo $key;
?>
        </div>
    </header>
    <section class="text-center content-section" id="about">
        <div class="container">
            <div class="row">
                <div class="col-auto col-lg-8 col-xl-10 mx-auto">
                    <h2 style="font-size: 43px;margin: 0px;">&nbsp;</h2><h2 style="font-size: 43px;margin: 0px;">Key: <?php echo $key ?>
<?php
$command1 = escapeshellcmd("python3 MD5Hash.py $key");
$output = shell_exec($command1);
echo "<br>Hash: ";
echo $output;

?>
</h2>
                    <h2 style="font-size: 43px;margin: 0px;">BIOGRAPHY</h2>
                </div>
            </div>
            <div class="row">
                <div class="col"></div>
            </div>
            <div class="row">
                <div class="col">
                    <h2><br>Location</h2><h3 class="text-start" style="margin: 35px;text-align:center !important;"> <?php echo $lat;?>, <?php echo $lon;?></h3>


<div class="mapouter"><div class="gmap_canvas"><iframe width="600" height="500" id="gmap_canvas" src="https://maps.google.com/maps?q=<?php echo $lat;?>,<?php echo $lon;?>&t=k&z=3&ie=UTF8&iwloc=&output=embed" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe><a href="https://www.embedgooglemap.org">embed google maps</a></div><style>.mapouter{position:relative;text-align:right;height:500px;width:600px;}.gmap_canvas {overflow:hidden;background:none!important;height:500px;width:600px;}</style></div>

                </div>
                <div class="col" style="margin-top: 25px;">
                    <div class="table-responsive">
                        <table class="table table-borderless">
                            <tbody style="color: var(--bs-light);">
                                <tr>
                                    <td style="color: var(--bs-white);">
                                        <section class="highlight-blue">
                                            <div class="container">
                                                <div class="intro">
                                                    <h2 class="text-center"><div><?php echo $fall;?> <br>fall</div></h2>
                                                    <p class="text-center">fall time</p>
                                                </div>
                                                <div class="buttons"></div>
                                            </div>
                                        </section>
                                    </td>
                                    <td>
                                        <section class="highlight-blue">
                                            <div class="container">
                                                <div class="intro">
                                                    <h2 class="text-center"><div><?php echo $rise;?> <br>seconds</div></h2>
                                                    <p class="text-center">lifetime</p>
                                                </div>
                                                <div class="buttons"></div>
                                            </div>
                                        </section>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <section class="highlight-blue">
                                            <div class="container">
                                                <div class="intro">
                                                    <h2 class="text-center"><div><?php echo $peak;?> <br>MWh</div></h2>
                                                    <p class="text-center">power output</p>
                                                </div>
                                                <div class="buttons"></div>
                                            </div>
                                        </section>
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer>
        <div class="container text-center">
            <p>Copyright ©&nbsp;Project Thor 2022</p>
        </div><!--Start of Tawk.to Script-->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/6206c37b9bd1f31184dc35c0/1frl6n72b';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
<!--End of Tawk.to Script-->
    </footer>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bs-init.js"></script>
    <script src="assets/js/Animated-numbers-section.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
    <script src="assets/js/scroll.js"></script>
</body>

</html>